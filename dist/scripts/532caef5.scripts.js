"use strict";angular.module("mooditor",["btford.markdown"]),angular.module("mooditor").controller("MainCtrl",["$scope","localStorageService","fileReader",function(a,b,c){a.editorBox={},a.editorBox.editing=!1,a.content=b.get("content")||"An h1 header \n============ \n* list 1 \n* list 2",a.image=b.get("img")||"",a.save=function(a){b.add("content",a)},a.remove=function(){b.remove("content")},a.getFile=function(d){c.readAsDataUrl(d,a).then(function(c){a.image=c,b.add("img",c)})}}]),angular.module("mooditor").factory("localStorageService",function(){return{get:function(a){return JSON.parse(localStorage.getItem(a))},add:function(a,b){localStorage.setItem(a,JSON.stringify(b))},remove:function(a){localStorage.removeItem(a)},clearAll:function(){localStorage.clear()}}}).factory("fileReader",["$q",function(a){var b=function(a,b,c){return function(){c.$apply(function(){b.resolve(a.result)})}},c=function(a,b,c){return function(){c.$apply(function(){b.reject(a.result)})}},d=function(a,d){var e=new FileReader;return e.onload=b(e,a,d),e.onerror=c(e,a,d),e},e=function(b,c){console.log(b);var e=a.defer(),f=d(e,c);return f.readAsDataURL(b),e.promise};return{readAsDataUrl:e}}]),angular.module("mooditor").directive("ngFileSelect",function(){return{link:function(a,b){b.bind("change",function(b){a.file=(b.srcElement||b.target).files[0],a.getFile(a.file)})}}});